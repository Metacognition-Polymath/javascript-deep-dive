# 14. 전역 변수의 문제점

## 14.1 변수의 생명 주기

### 지역 변수의 생명 주기

- 지역변수의 생명 주기는 함수의 생명주기와 일치한다.
- 변수의 생명주기 : 메모리공간 확보된 시점 -> 메모리 공간이 해제되어 가용메모리 풀에 반환되는 시점까지
- 할당된 메모리 공간은 누군가 참조하고 있으면 해제되지 않고 확보된 상태로 남아있게 된다(스코프도 마찬가지)
  - 24장 클로저에서 더 자세히 다룸

### 전역 변수의 생명 주기

- 전역 객체의 생명 주기와 같다

## 14.2 전역 변수의 문제점

- 암묵적 결합
  - 모든 코드가 전역 변수를 참조하고 변경할 수 있는 암묵적 결합을 허용하는 것
- 긴 생명 주기

  - 전역 변수는 생명주기가 길다. 따라서 메모리 리소스도 오랜 기간 소비한다
  - 전역 변수의 상태를 변경할 수 있는 시간도 길고 기회도 많다

- 스코프 체인 상에서 종점에 존재

  - 전역변수의 검색속도가 가장 느리다

- 네임스페이스 오염
  - 자바스크립트의 가장 큰 문제점 : 파일이 분리되어 있다 해도 하나의 전역 스코프를 공유

## 14.3 전역 변수의 사용을 억제하는 방법

- 지역 변수를 사용하는 것이 좋다. 변수의 스코프는 좁을 수록 좋다.

### 즉시 실행 함수

### 네임스페이스 객체

### 모듈 패턴

```js
// 예제 14-7 모듈 패턴
var Counter = (function () {
  var num = 0;
  return {
    increase() {
      return ++num;
    },
    decrease() {
      return --num;
    },
  };
})();

console.log(Counter.increase());
console.log(Counter.increase());
console.log(Counter.decrease());
// console.log(Counter.num); // undefined
```

### ES6 모듈

```html
<script type="module" src="lib.mjs"></script>
```

- module키워드가 붙은 파일에선 전역변수가 더 이상 window객체의 프로퍼티가 아니다.
- 아직까지 Webpack 등의 모듈 번들러를 사용하는 것이 일반적
  - 48장 모듈, 49장 Babel과 Webpack을 이용한 개발환경 구축에서 자세히 다룸
