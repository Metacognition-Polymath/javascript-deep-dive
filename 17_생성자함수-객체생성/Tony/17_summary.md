# 17. 생성자 함수에 의한 객체 생성

- 객체 리터럴에 의한 객체 생성 : `{}`
- 생성자 함수에 의한 객체 생성 : new Object()

## 17.1 Object 생성자 함수

- 객체 리터럴을 사용하는 것이 더 간편하다
- Object 생성자 함수 외에도 String, Number, Boolean, Function, Array, Date, RegExp, Promise 등
  빌트인 생성자 함수를 제공

## 17.2 생서자 함수

### 17.2.1 객체 리터럴에 의한 객체 생성 방식의 문제점

- 하나의 객체만 생성
- 동일한 프로퍼티를 갖는 객체를 여러 개 생성해야 하는 경우, 매번 같은 프로퍼티를 기술해야 하기 때문에 비효율적

### 17.2.2 생성자 함수에 의한 객체 생성 방식의 장점

- 동일한 구조의 객체를 여러개를 간편하게 생성할 수 있다

```js
function Circle(radius) {
  this.radius = radius;
  this.getDiameter = function () {
    return 2 * this.radius;
  };
}

const circle1 = new Circle(5);
const circle2 = new Circle(5);
```

#### this

- this가 가리키는 값
  - 일반 함수로서 호출 : 전역객체
  - 메서드로서 호출 : 메서드를 호출한 객체(마침표 앞의 객체)
  - 생성자 함수로서 호출(new) : 생성자 함수가 (미래에) 생성할 인스턴스

### 17.2.3 생성자 함수의 인스턴스 생성 과정

- 생성자 함수 몸체에서 수행해야 하는 것

  - 생성자 함수의 역할 : 구조가 동일한 인스턴스를 생성하기 위한 템플릿(클래스)으로서 동작하여 인스턴스를 생성하는 것
  - 생성된 인스턴스를 초기화(인스턴스 프로퍼티 추가 및 초기값 할당)하는 것

- 자바스크립트 엔진은 암묵적인 처리를 통해 new 연산자와 함께 생성자 함수를 호출하면 인스턴스를 생성하고 인스턴스를 초기화 한 후 인스턴스를 반환
  1. 인스턴스 생성과 this 바인딩
  2. 인스턴스 초기화
  3. 인스턴스 반환 - 생성자 함수 내부의 모든 처리가 끝나면 완성된 인스턴스(바인딩된 this)가 암묵적으로 반환된다
  - 생성자 함수 내부에서 return문을 반드시 생략해야 한다

### 17.2.4 내부 메서드 `[[call]]`과 `[[Construct]]`

- 화살표함수가 아닌 함수들은 생성자 함수로서 호출할 수 있다

  - new + 함수 실행

- 함수는 객체이지만 일반 객체와는 다르게 호출할 수 있다
  - 일반 객체가 가지고 있는 내부슬롯과 내부 메서드는 물론,
  - 함수로서 동작하기 위해 함수 객체만을 위한
    - [[Environment]], [[FormalParameter]] 등의 내부 슬롯과
    - [[call]], [[Construct]] 같은 내부 메서드를 추가로 가지고 있다
      - 일반 함수로서 호출되면 [[call]]이 호출되고
      - 생성자 함수로서 호출되면 [[Construct]]가 호출된다

### 17.2.5 constructor와 non-constructor의 구분

- 자바스크립트엔진이 constructor와 non-constructor를 구분하는 방법
  - 함수 객체를 생성할 때 함수 정의 방식에 따라 함수를 constructor와 non-constructor로 구분한다
  - constructor : 함수 선언문, 함수 표현식, 클래스(클래스도 함수다)
  - non-constructor : 메서드(ES6 메서드 축약 표현), 화살표 함수

### 17.2.6 new 연산자

- 일반함수와 생성자 함수를 구분하기 위해 생성자함수는 파스칼 케이스(첫 문자를 대문자)를 사용하여 구분하는 것이 관례이다

### 17.2.7 new.target

- 생성자 함수 내에서 new.target을 사용하면 생성자 함수로서 호출되었는지 확인할 수 있다
  - 생성자함수로 호출되면 new.target은 함수 자신을 가리킨다
  - 일반함수에서 new.target은 undefined이다.
